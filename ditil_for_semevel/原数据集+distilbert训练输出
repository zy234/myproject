ssh://zhaoy@lab.xxeasy.net:6004/home/lab/anaconda3/bin/python -u /data/zhaoy/myProject/ditil_for_semevel/orig_dtb_sem.py
--------------------------------------------------
数据加载完毕
训练集数量：8000， 测试集数量：2717
--------------------------------------------------
训练开始, batch_size为：32, epoch为30
epoch:0
迭代0次，平均loss为1.9082238674163818
迭代1600次，平均loss为2.093756914138794
迭代3200次，平均loss为0.8782959580421448
迭代4800次，平均loss为0.7834157943725586
迭代6400次，平均loss为0.3357800841331482
epoch0训练完毕，loss 为：1.0445947647094727
训练集因果的平均precision:0.16298168035375868, recall:0.12332695984703633, f1:0.14040816326530614
测试集因果的平均precision:0.11948529411764706, recall:0.0951683748169839, f1:0.10594947025264875
训练集混淆矩阵：
[[134285    417    245    501      4]
 [   845     80     22     54      2]
 [    29      2     17      2      0]
 [   782     42     19    157      3]
 [    20      5      2      5      4]]
测试集混淆矩阵：
[[45751   179    69   175     4]
 [  282    17     8    21     0]
 [   12     0     3     1     0]
 [  263    11     8    45     1]
 [    9     1     0     1     0]]
--------------------------------------------------
epoch:1
迭代0次，平均loss为0.6579292416572571
迭代1600次，平均loss为0.5083706974983215
迭代3200次，平均loss为0.8740089535713196
迭代4800次，平均loss为1.1309114694595337
迭代6400次，平均loss为0.953016459941864
epoch1训练完毕，loss 为：0.7689086198806763
训练集因果的平均precision:0.1411123227917121, recall:0.30927342256214146, f1:0.19379961060356446
测试集因果的平均precision:0.10587475790832795, recall:0.24011713030746706, f1:0.14695340501792115
训练集混淆矩阵：
[[131928    799   1084   1465    176]
 [   544    213     92    143     11]
 [     4      0     44      2      0]
 [   481     69     57    366     30]
 [     2      1      3      6     24]]
测试集混淆矩阵：
[[44949   294   361   505    69]
 [  200    38    34    52     4]
 [    4     3     6     2     1]
 [  155    20    25   119     9]
 [    4     2     1     3     1]]
--------------------------------------------------
epoch:2
迭代0次，平均loss为0.7672992944717407
迭代1600次，平均loss为0.5588971972465515
迭代3200次，平均loss为1.1027954816818237
迭代4800次，平均loss为0.45959120988845825
迭代6400次，平均loss为0.22761519253253937
epoch2训练完毕，loss 为：0.5801101326942444
训练集因果的平均precision:0.21843434343434343, recall:0.4134799235181644, f1:0.2858559153998678
测试集因果的平均precision:0.14814814814814814, recall:0.2752562225475842, f1:0.19262295081967212
训练集混淆矩阵：
[[132699   1034    287   1378     54]
 [   460    327     29    182      5]
 [     2      0     45      3      0]
 [   421     86     18    466     12]
 [     2      0      2      5     27]]
测试集混淆矩阵：
[[45235   364    92   458    29]
 [  199    55    14    58     2]
 [    6     4     4     2     0]
 [  149    35     9   129     6]
 [    3     3     0     5     0]]
--------------------------------------------------
epoch:3
迭代0次，平均loss为0.47563716769218445
迭代1600次，平均loss为0.7619317770004272
迭代3200次，平均loss为0.2662801146507263
迭代4800次，平均loss为0.5351759195327759
迭代6400次，平均loss为0.3095533549785614
epoch3训练完毕，loss 为：0.4579528868198395
训练集因果的平均precision:0.22805920366895976, recall:0.5229445506692161, f1:0.31760778051966904
测试集因果的平均precision:0.14790139906728847, recall:0.32503660322108346, f1:0.2032967032967033
训练集混淆矩阵：
[[132159   1444    541   1265     43]
 [   320    470     56    153      4]
 [     1      0     49      0      0]
 [   267    123     60    549      4]
 [     0      1      8      1     26]]
测试集混淆矩阵：
[[45062   487   156   450    23]
 [  172    73    23    59     1]
 [    5     6     4     1     0]
 [  118    42    21   145     2]
 [    3     3     1     4     0]]
--------------------------------------------------
epoch:4
迭代0次，平均loss为0.48462405800819397
迭代1600次，平均loss为0.44657468795776367
迭代3200次，平均loss为0.35934948921203613
迭代4800次，平均loss为0.0994638055562973
迭代6400次，平均loss为0.2534971833229065
epoch4训练完毕，loss 为：0.38347116112709045
训练集因果的平均precision:0.2943127962085308, recall:0.5936902485659655, f1:0.3935361216730038
测试集因果的平均precision:0.1921182266009852, recall:0.34260614934114203, f1:0.24618621778011576
训练集混淆矩阵：
[[132790   1303    131   1164     64]
 [   296    524      9    165      9]
 [     0      0     45      4      1]
 [   238    107     11    638      9]
 [     0      0      0      1     35]]
测试集混淆矩阵：
[[45325   443    32   354    24]
 [  183    77     7    58     3]
 [    5     8     0     3     0]
 [  127    37     2   157     5]
 [    3     3     1     4     0]]
--------------------------------------------------
epoch:5
迭代0次，平均loss为0.30591344833374023
迭代1600次，平均loss为0.3029281198978424
迭代3200次，平均loss为0.32675236463546753
迭代4800次，平均loss为0.5816479921340942
迭代6400次，平均loss为0.2675556242465973
epoch5训练完毕，loss 为：0.32904934883117676
训练集因果的平均precision:0.21476698483997755, recall:0.731357552581262, f1:0.33203125000000006
测试集因果的平均precision:0.13812154696132597, recall:0.43923865300146414, f1:0.21015761821366027
训练集混淆矩阵：
[[130287   2106     84   2910     65]
 [    75    632      8    281      7]
 [     0      0     49      1      0]
 [    58    109     10    814     12]
 [     0      0      1      0     35]]
测试集混淆矩阵：
[[44473   706    18   950    31]
 [  129    95     3    98     3]
 [    4     9     0     3     0]
 [   81    39     0   204     4]
 [    2     2     0     6     1]]
--------------------------------------------------
epoch:6
迭代0次，平均loss为0.12315069884061813
迭代1600次，平均loss为0.3032832741737366
迭代3200次，平均loss为0.2574802339076996
迭代4800次，平均loss为0.25424596667289734
迭代6400次，平均loss为0.21851901710033417
epoch6训练完毕，loss 为：0.2840929627418518
训练集因果的平均precision:0.2337243401759531, recall:0.7619502868068834, f1:0.35771992818671455
测试集因果的平均precision:0.1448692152917505, recall:0.4216691068814056, f1:0.2156495694496443
训练集混淆矩阵：
[[130643   1746    345   2640     78]
 [    53    653     28    264      5]
 [     0      0     50      0      0]
 [    28     74     37    859      5]
 [     0      0      4      0     32]]
测试集混淆矩阵：
[[44650   583    70   847    28]
 [  130    85    11   100     2]
 [    5     8     0     3     0]
 [   86    31     8   203     0]
 [    2     3     1     5     0]]
--------------------------------------------------
epoch:7
迭代0次，平均loss为0.23677022755146027
迭代1600次，平均loss为0.2107824832201004
迭代3200次，平均loss为0.21888870000839233
迭代4800次，平均loss为0.27418404817581177
迭代6400次，平均loss为0.12629586458206177
epoch7训练完毕，loss 为：0.24477066099643707
训练集因果的平均precision:0.34358288770053474, recall:0.737093690248566, f1:0.468693009118541
测试集因果的平均precision:0.20869565217391303, recall:0.3513909224011713, f1:0.26186579378068736
训练集混淆矩阵：
[[132848   1094    424   1009     77]
 [   118    679     39    163      4]
 [     0      0     50      0      0]
 [    90     97     34    777      5]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45396   359    69   324    30]
 [  182    77    10    57     2]
 [    7     6     0     3     0]
 [  123    35     6   163     1]
 [    3     3     1     4     0]]
--------------------------------------------------
epoch:8
迭代0次，平均loss为0.2507322430610657
迭代1600次，平均loss为0.09651589393615723
迭代3200次，平均loss为0.20241592824459076
迭代4800次，平均loss为0.19866766035556793
迭代6400次，平均loss为0.18386073410511017
epoch8训练完毕，loss 为：0.2188107967376709
训练集因果的平均precision:0.38437796771130106, recall:0.7739005736137667, f1:0.5136421319796954
测试集因果的平均precision:0.22684310018903592, recall:0.3513909224011713, f1:0.27570361860999426
训练集混淆矩阵：
[[133142   1544    113    622     31]
 [   103    801      9     85      5]
 [     0      0     50      0      0]
 [    87    167     11    732      6]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45479   456    21   205    17]
 [  187    94     4    41     2]
 [    6     9     0     1     0]
 [  128    49     2   146     3]
 [    3     5     0     3     0]]
--------------------------------------------------
epoch:9
迭代0次，平均loss为0.06397197395563126
迭代1600次，平均loss为0.2520900070667267
迭代3200次，平均loss为0.16887277364730835
迭代4800次，平均loss为0.3436957895755768
迭代6400次，平均loss为0.251271516084671
epoch9训练完毕，loss 为：0.1926996111869812
训练集因果的平均precision:0.41269060501721594, recall:0.8021032504780115, f1:0.5449821370574862
测试集因果的平均precision:0.23166023166023167, recall:0.3513909224011713, f1:0.27923211169284473
训练集混淆矩阵：
[[133330    988    170    922     42]
 [    83    759     16    139      6]
 [     0      0     50      0      0]
 [    65     88     14    833      3]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45505   321    33   302    17]
 [  183    78     4    61     2]
 [    7     6     1     2     0]
 [  126    32     4   161     5]
 [    4     3     1     3     0]]
--------------------------------------------------
epoch:10
迭代0次，平均loss为0.1959763467311859
迭代1600次，平均loss为0.07007209956645966
迭代3200次，平均loss为0.17421123385429382
迭代4800次，平均loss为0.19538255035877228
迭代6400次，平均loss为0.11566753685474396
epoch10训练完毕，loss 为：0.17377081513404846
训练集因果的平均precision:0.4561497326203209, recall:0.8154875717017208, f1:0.5850480109739369
测试集因果的平均precision:0.25260960334029225, recall:0.35431918008784774, f1:0.2949421084704448
训练集混淆矩阵：
[[133633    961     60    762     36]
 [    87    796      5    110      5]
 [     0      0     50      0      0]
 [    84     89      4    824      2]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45573   297    18   276    14]
 [  186    82     4    54     2]
 [    8     6     0     2     0]
 [  133    34     0   160     1]
 [    3     2     0     6     0]]
--------------------------------------------------
epoch:11
迭代0次，平均loss为0.10221634060144424
迭代1600次，平均loss为0.06524897366762161
迭代3200次，平均loss为0.11888792365789413
迭代4800次，平均loss为0.13269253075122833
迭代6400次，平均loss为0.1807345151901245
epoch11训练完毕，loss 为：0.1617872267961502
训练集因果的平均precision:0.3616486068111455, recall:0.8934034416826003, f1:0.5148760330578511
测试集因果的平均precision:0.2072463768115942, recall:0.41874084919472915, f1:0.2772661173048958
训练集混淆矩阵：
[[132356   1557     60   1416     63]
 [    10    890      7     91      5]
 [     0      0     50      0      0]
 [    10     91      3    893      6]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45213   499    12   429    25]
 [  155   114     2    53     4]
 [    7     7     0     2     0]
 [  104    47     1   172     4]
 [    2     5     0     4     0]]
--------------------------------------------------
epoch:12
迭代0次，平均loss为0.1946181058883667
迭代1600次，平均loss为0.13288037478923798
迭代3200次，平均loss为0.12790490686893463
迭代4800次，平均loss为0.06728851795196533
迭代6400次，平均loss为0.15609824657440186
epoch12训练完毕，loss 为：0.14500348269939423
训练集因果的平均precision:0.4341828384381576, recall:0.8876673040152964, f1:0.5831370701837023
测试集因果的平均precision:0.23290203327171904, recall:0.3689604685212299, f1:0.28555240793201137
训练集混淆矩阵：
[[133228   1096    139    953     36]
 [    20    887      8     84      4]
 [     0      0     50      0      0]
 [    19     90      7    884      3]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45477   345    30   309    17]
 [  175    95     5    51     2]
 [    6     7     0     3     0]
 [  118    49     2   157     2]
 [    3     5     0     3     0]]
--------------------------------------------------
epoch:13
迭代0次，平均loss为0.12382592260837555
迭代1600次，平均loss为0.07172255218029022
迭代3200次，平均loss为0.173238605260849
迭代4800次，平均loss为0.175877645611763
迭代6400次，平均loss为0.11170851439237595
epoch13训练完毕，loss 为：0.13081054389476776
训练集因果的平均precision:0.5543977934416181, recall:0.8647227533460803, f1:0.6756302521008403
测试集因果的平均precision:0.30952380952380953, recall:0.34260614934114203, f1:0.325225851285615
训练集混淆矩阵：
[[134137    871     39    389     16]
 [    67    897      2     33      4]
 [     0      0     50      0      0]
 [    77     99      1    826      0]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45743   260     9   155    11]
 [  197    94     2    34     1]
 [    8     7     0     1     0]
 [  153    34     0   140     1]
 [    4     4     0     3     0]]
--------------------------------------------------
epoch:14
迭代0次，平均loss为0.2004445642232895
迭代1600次，平均loss为0.055055756121873856
迭代3200次，平均loss为0.0897960513830185
迭代4800次，平均loss为0.07110672444105148
迭代6400次，平均loss为0.1348743885755539
epoch14训练完毕，loss 为：0.12829704582691193
训练集因果的平均precision:0.38484136310223266, recall:0.9392925430210325, f1:0.5459849958321756
测试集因果的平均precision:0.2050561797752809, recall:0.42752562225475843, f1:0.27717133364973895
训练集混淆矩阵：
[[132433   1313     95   1532     79]
 [     2    926      5     66      4]
 [     0      0     50      0      0]
 [     3     35      7    953      5]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45180   479    22   477    20]
 [  152   111     3    60     2]
 [    5     8     1     2     0]
 [   98    45     2   179     4]
 [    2     2     0     6     1]]
--------------------------------------------------
epoch:15
迭代0次，平均loss为0.04282602295279503
迭代1600次，平均loss为0.13350842893123627
迭代3200次，平均loss为0.17485731840133667
迭代4800次，平均loss为0.09880958497524261
迭代6400次，平均loss为0.22488032281398773
epoch15训练完毕，loss 为：0.11206120997667313
训练集因果的平均precision:0.4903677758318739, recall:0.9369024856596558, f1:0.64378387255707
测试集因果的平均precision:0.2702188392007612, recall:0.4158125915080527, f1:0.3275663206459054
训练集混淆矩阵：
[[133507    999     58    870     18]
 [    20    922      2     56      3]
 [     0      0     50      0      0]
 [    20     29      1    952      1]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45514   347    17   289    11]
 [  171   105     2    50     0]
 [    7     6     0     3     0]
 [  115    33     0   179     1]
 [    3     2     0     6     0]]
--------------------------------------------------
epoch:16
迭代0次，平均loss为0.06532232463359833
迭代1600次，平均loss为0.10163883864879608
迭代3200次，平均loss为0.049116719514131546
迭代4800次，平均loss为0.049529779702425
迭代6400次，平均loss为0.09376312792301178
epoch16训练完毕，loss 为：0.1013769656419754
训练集因果的平均precision:0.4050454086781029, recall:0.9593690248565966, f1:0.5696040868454662
测试集因果的平均precision:0.22808267997148968, recall:0.4685212298682284, f1:0.30680728667305845
训练集混淆矩阵：
[[132584   1484    104   1219     61]
 [     1    951      3     45      3]
 [     0      0     50      0      0]
 [     4     21      4    970      4]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45211   504    22   418    23]
 [  149   118     2    56     3]
 [    6     7     2     1     0]
 [   89    35     1   200     3]
 [    3     3     0     5     0]]
--------------------------------------------------
epoch:17
迭代0次，平均loss为0.08134349435567856
迭代1600次，平均loss为0.1425347775220871
迭代3200次，平均loss为0.09066901355981827
迭代4800次，平均loss为0.061101555824279785
迭代6400次，平均loss为0.19152222573757172
epoch17训练完毕，loss 为：0.08821306377649307
训练集因果的平均precision:0.4153720359771055, recall:0.97131931166348, f1:0.5819014891179839
测试集因果的平均precision:0.22736842105263158, recall:0.4743777452415813, f1:0.3074003795066414
训练集混淆矩阵：
[[132652   1504     93   1122     81]
 [     0    975      2     22      4]
 [     0      0     50      0      0]
 [     0     27      4    971      1]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45192   510    22   424    30]
 [  141   130     4    49     4]
 [    7     6     1     2     0]
 [   94    38     1   193     2]
 [    2     2     0     7     0]]
--------------------------------------------------
epoch:18
迭代0次，平均loss为0.06824375689029694
迭代1600次，平均loss为0.060470517724752426
迭代3200次，平均loss为0.04836638271808624
迭代4800次，平均loss为0.03577703982591629
迭代6400次，平均loss为0.03691411018371582
epoch18训练完毕，loss 为：0.08218301832675934
训练集因果的平均precision:0.5455764075067024, recall:0.972753346080306, f1:0.6990724836825832
测试集因果的平均precision:0.296875, recall:0.445095168374817, f1:0.3561804335090803
训练集混淆矩阵：
[[133791    749     46    844     22]
 [    14    964      2     22      1]
 [     0      0     50      0      0]
 [     9      5      2    985      2]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45547   286    12   316    17]
 [  168   113     3    42     2]
 [    8     7     1     0     0]
 [  111    25     0   190     2]
 [    3     3     0     5     0]]
--------------------------------------------------
epoch:19
迭代0次，平均loss为0.06565600633621216
迭代1600次，平均loss为0.08616359531879425
迭代3200次，平均loss为0.13967265188694
迭代4800次，平均loss为0.12289497256278992
迭代6400次，平均loss为0.029991168528795242
epoch19训练完毕，loss 为：0.07356543093919754
训练集因果的平均precision:0.535966518441015, recall:0.9794455066921606, f1:0.692814877430262
测试集因果的平均precision:0.28487229862475444, recall:0.424597364568082, f1:0.3409758965314521
训练集混淆矩阵：
[[133714    686     60    951     41]
 [     6    971      2     22      2]
 [     0      0     50      0      0]
 [     1      5      0    992      5]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45534   271    16   339    18]
 [  177   109     3    36     3]
 [    8     6     1     1     0]
 [  120    24     0   179     5]
 [    4     2     0     4     1]]
--------------------------------------------------
epoch:20
迭代0次，平均loss为0.07622222602367401
迭代1600次，平均loss为0.030405836179852486
迭代3200次，平均loss为0.03337235003709793
迭代4800次，平均loss为0.06754244863986969
迭代6400次，平均loss为0.0218742024153471
epoch20训练完毕，loss 为：0.05966838076710701
训练集因果的平均precision:0.5313700384122919, recall:0.9918738049713193, f1:0.6920126730031682
测试集因果的平均precision:0.2846781504986401, recall:0.45973645680819913, f1:0.3516237402015678
训练集混淆矩阵：
[[133637    847     49    897     22]
 [     2    987      2     11      1]
 [     0      0     50      0      0]
 [     0      1      0   1002      0]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45471   323    15   354    15]
 [  164   121     2    40     1]
 [    9     5     1     1     0]
 [  111    24     0   192     1]
 [    3     2     0     6     0]]
--------------------------------------------------
epoch:21
迭代0次，平均loss为0.008292860351502895
迭代1600次，平均loss为0.11560989916324615
迭代3200次，平均loss为0.1093914806842804
迭代4800次，平均loss为0.08523031324148178
迭代6400次，平均loss为0.02227609045803547
epoch21训练完毕，loss 为：0.07039053738117218
训练集因果的平均precision:0.5089879340064024, recall:0.9880497131931166, f1:0.6718673817649927
测试集因果的平均precision:0.2694610778443114, recall:0.4612005856515373, f1:0.34017278617710583
训练集混淆矩阵：
[[133483    797     73   1003     96]
 [     0    988      1     13      1]
 [     0      0     50      0      0]
 [     0      0      1    993      9]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45408   302    18   414    36]
 [  160   127     3    38     0]
 [    8     8     0     0     0]
 [  112    21     0   188     7]
 [    4     2     0     5     0]]
--------------------------------------------------
epoch:22
迭代0次，平均loss为0.09469453990459442
迭代1600次，平均loss为0.018543513491749763
迭代3200次，平均loss为0.029032118618488312
迭代4800次，平均loss为0.25207027792930603
迭代6400次，平均loss为0.03293648362159729
epoch22训练完毕，loss 为：0.05273547023534775
训练集因果的平均precision:0.4872095752170852, recall:0.9923518164435946, f1:0.6535495041712577
测试集因果的平均precision:0.2617760617760618, recall:0.49633967789165445, f1:0.3427704752275025
训练集混淆矩阵：
[[133283    966     59   1084     60]
 [     0    991      1     10      1]
 [     0      0     50      0      0]
 [     0      0      0    999      4]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45301   349    19   484    25]
 [  155   134     3    36     0]
 [    8     7     1     0     0]
 [   98    20     0   204     6]
 [    4     2     0     5     0]]
--------------------------------------------------
epoch:23
迭代0次，平均loss为0.11557499319314957
迭代1600次，平均loss为0.05757834389805794
迭代3200次，平均loss为0.04975965619087219
迭代4800次，平均loss为0.025215983390808105
迭代6400次，平均loss为0.02178688533604145
epoch23训练完毕，loss 为：0.05429541692137718
训练集因果的平均precision:0.5670019026909486, recall:0.997131931166348, f1:0.7229249696759661
测试集因果的平均precision:0.31893004115226337, recall:0.4538799414348463, f1:0.37462235649546827
训练集混淆矩阵：
[[133865    890     57    621     19]
 [     0   1001      1      1      0]
 [     0      0     50      0      0]
 [     0      0      1   1000      2]
 [     0      0      1      0     35]]
测试集混淆矩阵：
[[45589   329    14   234    12]
 [  160   141     3    24     0]
 [    7     9     0     0     0]
 [  129    26     1   169     3]
 [    4     2     0     5     0]]
--------------------------------------------------
epoch:24
迭代0次，平均loss为0.031716488301754
迭代1600次，平均loss为0.016046682372689247
迭代3200次，平均loss为0.004745688289403915
迭代4800次，平均loss为0.0509985126554966
迭代6400次，平均loss为0.007346205413341522
epoch24训练完毕，loss 为：0.051168132573366165
训练集因果的平均precision:0.5424479166666667, recall:0.995697896749522, f1:0.7022926500337155
测试集因果的平均precision:0.30193905817174516, recall:0.4787701317715959, f1:0.3703284258210645
训练集混淆矩阵：
[[133702   1055     68    600     27]
 [     0   1001      2      0      0]
 [     0      0     50      0      0]
 [     2      3      2    996      0]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45498   391    17   258    14]
 [  154   144     3    26     1]
 [    7     8     1     0     0]
 [  115    26     2   182     3]
 [    4     3     0     4     0]]
--------------------------------------------------
epoch:25
迭代0次，平均loss为0.026323167607188225
迭代1600次，平均loss为0.04039968550205231
迭代3200次，平均loss为0.0062728142365813255
迭代4800次，平均loss为0.03996534273028374
迭代6400次，平均loss为0.009552018716931343
epoch25训练完毕，loss 为：0.036644697189331055
训练集因果的平均precision:0.5932443939824014, recall:0.9990439770554493, f1:0.7444345503116652
测试集因果的平均precision:0.3203285420944558, recall:0.4568081991215227, f1:0.3765841882920941
训练集混淆矩阵：
[[134021    788     43    572     28]
 [     0   1002      1      0      0]
 [     0      0     50      0      0]
 [     0      1      0   1002      0]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45586   306    13   259    14]
 [  166   132     2    26     2]
 [    8     7     1     0     0]
 [  123    23     2   179     1]
 [    4     3     0     4     0]]
--------------------------------------------------
epoch:26
迭代0次，平均loss为0.03776056692004204
迭代1600次，平均loss为0.052043549716472626
迭代3200次，平均loss为0.0035654751118272543
迭代4800次，平均loss为0.12968267500400543
迭代6400次，平均loss为0.02264542505145073
epoch26训练完毕，loss 为：0.029222507029771805
训练集因果的平均precision:0.6499688861232109, recall:0.998565965583174, f1:0.7874104787033547
测试集因果的平均precision:0.3759894459102902, recall:0.4172767203513909, f1:0.395558639833449
训练集混淆矩阵：
[[134330    609     41    441     31]
 [     0   1001      2      0      0]
 [     0      0     50      0      0]
 [     0      0      1   1002      0]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45761   235    11   158    13]
 [  183   121     2    21     1]
 [   10     5     1     0     0]
 [  145    17     0   163     3]
 [    4     2     0     5     0]]
--------------------------------------------------
epoch:27
迭代0次，平均loss为0.008538453839719296
迭代1600次，平均loss为0.03800583258271217
迭代3200次，平均loss为0.08450957387685776
迭代4800次，平均loss为0.018349379301071167
迭代6400次，平均loss为0.028101211413741112
epoch27训练完毕，loss 为：0.030222278088331223
训练集因果的平均precision:0.5967465753424658, recall:0.9995219885277247, f1:0.7473195139385276
测试集因果的平均precision:0.3230769230769231, recall:0.49194729136163984, f1:0.3900174114915845
训练集混淆矩阵：
[[134040    773     31    583     25]
 [     0   1002      1      0      0]
 [     0      0     50      0      0]
 [     0      0      0   1003      0]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45536   327    10   292    13]
 [  156   148     2    22     0]
 [    8     7     1     0     0]
 [  117    22     0   187     2]
 [    4     2     0     5     0]]
--------------------------------------------------
epoch:28
迭代0次，平均loss为0.022790489718317986
迭代1600次，平均loss为0.029803231358528137
迭代3200次，平均loss为0.006807580124586821
迭代4800次，平均loss为0.05615638941526413
迭代6400次，平均loss为0.0226119551807642
epoch28训练完毕，loss 为：0.027340169996023178
训练集因果的平均precision:0.6931742876076872, recall:1.0, f1:0.8187866927592955
测试集因果的平均precision:0.37467018469656993, recall:0.4158125915080527, f1:0.39417071478140175
训练集混淆矩阵：
[[134526    366     67    446     47]
 [     0   1003      0      0      0]
 [     0      0     50      0      0]
 [     0      0      0   1003      0]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45762   171    22   208    15]
 [  191   106     4    26     1]
 [    9     6     1     0     0]
 [  136    11     2   176     3]
 [    5     2     0     3     1]]
--------------------------------------------------
epoch:29
迭代0次，平均loss为0.0022984552197158337
迭代1600次，平均loss为0.030721167102456093
迭代3200次，平均loss为0.025199709460139275
迭代4800次，平均loss为0.040695082396268845
迭代6400次，平均loss为0.008591183461248875
epoch29训练完毕，loss 为：0.02710466831922531
训练集因果的平均precision:0.6572327044025157, recall:0.9990439770554493, f1:0.7928679817905918
测试集因果的平均precision:0.3451025056947608, recall:0.44363103953147875, f1:0.3882126841768097
训练集混淆矩阵：
[[134364    620     36    403     29]
 [     0   1002      1      0      0]
 [     0      0     50      0      0]
 [     0      0      1   1002      0]
 [     0      0      0      0     36]]
测试集混淆矩阵：
[[45662   298     9   199    10]
 [  175   128     3    21     1]
 [   11     4     1     0     0]
 [  131    19     1   174     3]
 [    4     3     0     4     0]]
--------------------------------------------------
--------------------------------------------------
训练结束，保存模型
--------------------------------------------------
训练结束，最好的f1值为0.395558639833449， 混淆矩阵为[[45761   235    11   158    13]
 [  183   121     2    21     1]
 [   10     5     1     0     0]
 [  145    17     0   163     3]
 [    4     2     0     5     0]]
模型保存完毕

Process finished with exit code 0
