nohup: 忽略输入
['/data/zhaoy/myProject/bert_for_ce', '/home/lab/anaconda3/lib/python37.zip', '/home/lab/anaconda3/lib/python3.7', '/home/lab/anaconda3/lib/python3.7/lib-dynload', '/home/lab/anaconda3/lib/python3.7/site-packages', '/home/lab/anaconda3/lib/python3.7/site-packages/IPython/extensions']
--------------------------------------------------
数据加载完毕
训练集数量：13015， 测试集数量：2717
--------------------------------------------------
训练开始, batch_size为：32, epoch为30
epoch:0
迭代0次，平均loss为2.0087268352508545
迭代1600次，平均loss为0.2623094618320465
迭代3200次，平均loss为0.12059355527162552
迭代4800次，平均loss为0.12884007394313812
迭代6400次，平均loss为0.11895547807216644
迭代8000次，平均loss为0.1376153975725174
迭代9600次，平均loss为0.06877095997333527
迭代11200次，平均loss为0.05872861295938492
迭代12800次，平均loss为0.08937834203243256
epoch0训练完毕，loss 为：0.16807790441906512
训练集因果的平均precision:0.7731301736136547, recall:0.8413584183673469, f1:0.8058026340904751
测试集因果的平均precision:0.5742009132420092, recall:0.7364568081991215, f1:0.6452854393842207
训练集混淆矩阵：
[[215986   1138      0   1222      0]
 [   681   5189      0    144      0]
 [    29    269      0      2      0]
 [   522    127      0   5365      0]
 [    21      5      0    190      0]]
测试集混淆矩阵：
[[45846   159     0   173     0]
 [   85   239     0     4     0]
 [    1    15     0     0     0]
 [   53    11     0   264     0]
 [    0     0     0    11     0]]
--------------------------------------------------
epoch:1
迭代0次，平均loss为0.029763100668787956
迭代1600次，平均loss为0.07162688672542572
迭代3200次，平均loss为0.05943017452955246
迭代4800次，平均loss为0.05853681638836861
迭代6400次，平均loss为0.061706870794296265
迭代8000次，平均loss为0.051219694316387177
迭代9600次，平均loss为0.04531439393758774
迭代11200次，平均loss为0.046135932207107544
迭代12800次，平均loss为0.040767550468444824
epoch1训练完毕，loss 为：0.051098927456353395
训练集因果的平均precision:0.8886181956604492, recall:0.9304846938775511, f1:0.9090696678219558
测试集因果的平均precision:0.6466257668711657, recall:0.7715959004392386, f1:0.7036048064085448
训练集混淆矩阵：
[[217368    550      7    421      0]
 [   180   5764     15     55      0]
 [     7    144    149      0      0]
 [   193     65      3   5750      3]
 [     7      1      0    199      9]]
测试集混淆矩阵：
[[45921   141     2   114     0]
 [   65   258     2     3     0]
 [    1    14     1     0     0]
 [   58     2     0   268     0]
 [    1     0     0    10     0]]
--------------------------------------------------
epoch:2
迭代0次，平均loss为0.03500056639313698
迭代1600次，平均loss为0.024947592988610268
迭代3200次，平均loss为0.036220695823431015
迭代4800次，平均loss为0.025960469618439674
迭代6400次，平均loss为0.015666993334889412
迭代8000次，平均loss为0.018929457291960716
迭代9600次，平均loss为0.015429853461682796
迭代11200次，平均loss为0.010536645539104939
迭代12800次，平均loss为0.028858669102191925
epoch2训练完毕，loss 为：0.025668072595095875
训练集因果的平均precision:0.9694752576508536, recall:0.9823820153061225, f1:0.9758859631756088
测试集因果的平均precision:0.686141304347826, recall:0.739385065885798, f1:0.711768851303735
训练集混淆矩阵：
[[218085    122     13    125      1]
 [    58   5918     18     20      0]
 [     1      4    295      0      0]
 [    35     37      4   5914     24]
 [     0      0      0     20    196]]
测试集混淆矩阵：
[[45979    99     4    96     0]
 [   79   243     3     2     1]
 [    1    11     4     0     0]
 [   66     3     0   257     2]
 [    0     0     0    10     1]]
--------------------------------------------------
epoch:3
迭代0次，平均loss为0.00805822666734457
迭代1600次，平均loss为0.009480206295847893
迭代3200次，平均loss为0.009626109153032303
迭代4800次，平均loss为0.011835064738988876
迭代6400次，平均loss为0.004388439003378153
迭代8000次，平均loss为0.021442867815494537
迭代9600次，平均loss为0.005457254126667976
迭代11200次，平均loss为0.001288354629650712
迭代12800次，平均loss为0.002848661970347166
epoch3训练完毕，loss 为：0.012639690394423846
训练集因果的平均precision:0.979815501064417, recall:0.9906728316326531, f1:0.985214254568518
测试集因果的平均precision:0.6559006211180124, recall:0.7730600292825769, f1:0.7096774193548386
训练集混淆矩阵：
[[218166     87     14     78      1]
 [    19   5955     38      2      0]
 [     5      0    295      0      0]
 [    17     27      0   5964      6]
 [     0      0      0      3    213]]
测试集混淆矩阵：
[[45930   133     5   109     1]
 [   69   252     4     2     1]
 [    1    10     5     0     0]
 [   56     1     0   268     3]
 [    0     0     0     8     3]]
--------------------------------------------------
epoch:4
迭代0次，平均loss为0.011141851544380188
迭代1600次，平均loss为0.023616287857294083
迭代3200次，平均loss为0.008965438231825829
迭代4800次，平均loss为0.004916754551231861
迭代6400次，平均loss为0.016485286876559258
迭代8000次，平均loss为0.0055802022106945515
迭代9600次，平均loss为0.008963320404291153
迭代11200次，平均loss为0.00327332504093647
迭代12800次，平均loss为0.01364454161375761
epoch4训练完毕，loss 为：0.007192703571042684
训练集因果的平均precision:0.9938713785418657, recall:0.9954559948979592, f1:0.9946630555998088
测试集因果的平均precision:0.7496087636932708, recall:0.7013177159590044, f1:0.7246596066565809
训练集混淆矩阵：
[[218290     21      6     29      0]
 [    23   5987      2      2      0]
 [     0      0    300      0      0]
 [    13      8      0   5984      9]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46044    71     4    59     0]
 [   99   225     1     2     1]
 [    1    11     4     0     0]
 [   78     0     0   247     3]
 [    0     0     0     8     3]]
--------------------------------------------------
epoch:5
迭代0次，平均loss为0.004640285857021809
迭代1600次，平均loss为0.00575886620208621
迭代3200次，平均loss为0.0010809414088726044
迭代4800次，平均loss为0.0006673369207419455
迭代6400次，平均loss为0.0004661153943743557
迭代8000次，平均loss为0.00181667844299227
迭代9600次，平均loss为0.0005217799334786832
迭代11200次，平均loss为0.001285511301830411
迭代12800次，平均loss为0.00034373783273622394
epoch5训练完毕，loss 为：0.004952122729295736
训练集因果的平均precision:0.9954653937947494, recall:0.9975286989795918, f1:0.9964959783387752
测试集因果的平均precision:0.6930422919508867, recall:0.7437774524158126, f1:0.7175141242937854
训练集混淆矩阵：
[[218291     29      6     20      0]
 [    15   5998      1      0      0]
 [     0      0    300      0      0]
 [    14      1      0   5999      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[45983   102     6    86     1]
 [   79   245     1     2     1]
 [    1    12     3     0     0]
 [   65     3     0   257     3]
 [    0     0     0     8     3]]
--------------------------------------------------
epoch:6
迭代0次，平均loss为0.0010275703389197588
迭代1600次，平均loss为0.0003633379237726331
迭代3200次，平均loss为0.0005715870065614581
迭代4800次，平均loss为0.004330570809543133
迭代6400次，平均loss为0.0008375843171961606
迭代8000次，平均loss为0.0033411476761102676
迭代9600次，平均loss为0.0014236753340810537
迭代11200次，平均loss为0.013441626913845539
迭代12800次，平均loss为0.004234484396874905
epoch6训练完毕，loss 为：0.0034628739570332872
训练集因果的平均precision:0.9979249800478851, recall:0.9968112244897959, f1:0.9973677913376404
测试集因果的平均precision:0.7719298245614035, recall:0.7086383601756955, f1:0.7389312977099238
训练集混淆矩阵：
[[218323     15      6      2      0]
 [    18   5996      0      0      0]
 [     0      0    300      0      0]
 [    19      0      0   5992      3]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46056    67     4    49     2]
 [   96   229     0     2     1]
 [    3     7     6     0     0]
 [   78     1     0   245     4]
 [    1     0     0     6     4]]
--------------------------------------------------
epoch:7
迭代0次，平均loss为0.0007243754807859659
迭代1600次，平均loss为0.0021918697748333216
迭代3200次，平均loss为0.007996960543096066
迭代4800次，平均loss为0.000603606691583991
迭代6400次，平均loss为0.0017671280074864626
迭代8000次，平均loss为0.0005171675002202392
迭代9600次，平均loss为0.00033279243507422507
迭代11200次，平均loss为0.0011739643523469567
迭代12800次，平均loss为0.0007456599269062281
epoch7训练完毕，loss 为：0.0028077603302994374
训练集因果的平均precision:0.9988024908190963, recall:0.9973692602040817, f1:0.9980853609892302
测试集因果的平均precision:0.7380607814761215, recall:0.746705710102489, f1:0.74235807860262
训练集混淆矩阵：
[[218331      6      3      6      0]
 [    20   5994      0      0      0]
 [     0      0    300      0      0]
 [    13      0      0   6001      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46022    82     5    69     0]
 [   85   239     1     2     1]
 [    1    10     5     0     0]
 [   62     0     0   262     4]
 [    0     0     0     7     4]]
--------------------------------------------------
epoch:8
迭代0次，平均loss为0.004242392722517252
迭代1600次，平均loss为0.000363268016371876
迭代3200次，平均loss为0.0013576012570410967
迭代4800次，平均loss为0.00017559141269885004
迭代6400次，平均loss为0.0002253048005513847
迭代8000次，平均loss为0.0006205501849763095
迭代9600次，平均loss为0.0006808903999626637
迭代11200次，平均loss为0.00032006457331590354
迭代12800次，平均loss为0.008038196712732315
epoch8训练完毕，loss 为：0.002066669199956074
训练集因果的平均precision:0.9977675011959815, recall:0.9976084183673469, f1:0.9976879534401658
测试集因果的平均precision:0.7226277372262774, recall:0.7247437774524158, f1:0.7236842105263158
训练集混淆矩阵：
[[218318     16      6      5      1]
 [    14   6000      0      0      0]
 [     0      0    300      0      0]
 [    16      0      0   5998      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46014    92     6    66     0]
 [   85   239     1     2     1]
 [    1    12     3     0     0]
 [   76     1     0   250     1]
 [    0     0     0     8     3]]
--------------------------------------------------
epoch:9
迭代0次，平均loss为0.003351717721670866
迭代1600次，平均loss为0.00590642960742116
迭代3200次，平均loss为0.006486637517809868
迭代4800次，平均loss为0.001262498670257628
迭代6400次，平均loss为0.00020798387413378805
迭代8000次，平均loss为0.00029933886253274977
迭代9600次，平均loss为0.0013016191078349948
迭代11200次，平均loss为0.007915562950074673
迭代12800次，平均loss为0.00028141122311353683
epoch9训练完毕，loss 为：0.0023918252679990463
训练集因果的平均precision:0.9945255474452555, recall:0.9992825255102041, f1:0.9968983616987436
测试集因果的平均precision:0.7067567567567568, recall:0.7657393850658858, f1:0.7350667603654251
训练集混淆矩阵：
[[218278     41      3     24      0]
 [     2   6012      0      0      0]
 [     0      0    300      0      0]
 [     6      0      0   6007      1]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[45985   115     6    71     1]
 [   68   258     0     1     1]
 [    1    13     2     0     0]
 [   67     0     0   260     1]
 [    0     0     0     8     3]]
--------------------------------------------------
epoch:10
迭代0次，平均loss为0.0003135164442937821
迭代1600次，平均loss为0.00013443005445878953
迭代3200次，平均loss为0.0008256479050032794
迭代4800次，平均loss为0.0001935991458594799
迭代6400次，平均loss为0.0031495254952460527
迭代8000次，平均loss为0.00013900948397349566
迭代9600次，平均loss为0.012079117819666862
迭代11200次，平均loss为0.0007540888036601245
迭代12800次，平均loss为0.00012779270764440298
epoch10训练完毕，loss 为：0.0017394114219686223
训练集因果的平均precision:0.9974514176489327, recall:0.998405612244898, f1:0.9979282868525897
测试集因果的平均precision:0.7374045801526717, recall:0.7071742313323572, f1:0.7219730941704036
训练集混淆矩阵：
[[218314     22      6      4      0]
 [    10   6004      0      0      0]
 [     0      0    300      0      0]
 [    10      0      0   6004      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46034    83     4    55     2]
 [   88   237     0     2     1]
 [    1    13     2     0     0]
 [   83     1     0   241     3]
 [    0     0     0     8     3]]
--------------------------------------------------
epoch:11
迭代0次，平均loss为0.0011544683948159218
迭代1600次，平均loss为0.000119875228847377
迭代3200次，平均loss为0.0011444668052718043
迭代4800次，平均loss为0.00023279253218788654
迭代6400次，平均loss为0.00040878946310840547
迭代8000次，平均loss为0.000277193496003747
迭代9600次，平均loss为0.00010983753600157797
迭代11200次，平均loss为0.0001606372679816559
迭代12800次，平均loss为0.012653734534978867
epoch11训练完毕，loss 为：0.0017626399899670325
训练集因果的平均precision:0.998324557204404, recall:0.9975286989795918, f1:0.997926469415424
测试集因果的平均precision:0.723342939481268, recall:0.7349926793557833, f1:0.729121278140886
训练集混淆矩阵：
[[218326     12      4      4      0]
 [    14   6000      0      0      0]
 [     0      0    300      0      0]
 [    16      0      0   5997      1]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46011    76     4    84     3]
 [   86   237     2     2     1]
 [    2     9     5     0     0]
 [   68     1     0   256     3]
 [    0     0     0     7     4]]
--------------------------------------------------
epoch:12
迭代0次，平均loss为0.0008425532723776996
迭代1600次，平均loss为0.0006237457855604589
迭代3200次，平均loss为0.000241247151279822
迭代4800次，平均loss为0.0007202512351796031
迭代6400次，平均loss为7.458929030690342e-05
迭代8000次，平均loss为0.0015663233352825046
迭代9600次，平均loss为0.008718161843717098
迭代11200次，平均loss为0.004468456842005253
迭代12800次，平均loss为0.0025931778363883495
epoch12训练完毕，loss 为：0.0019249685481850178
训练集因果的平均precision:0.9980078093872021, recall:0.998405612244898, f1:0.9982066711831985
测试集因果的平均precision:0.7290132547864506, recall:0.7247437774524158, f1:0.7268722466960352
训练集混淆矩阵：
[[218321     15      3      7      0]
 [    10   6004      0      0      0]
 [     0      0    300      0      0]
 [    10      0      0   6004      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46021    80     4    71     2]
 [   89   235     1     2     1]
 [    1    12     3     0     0]
 [   71     0     0   255     2]
 [    0     0     0     9     2]]
--------------------------------------------------
epoch:13
迭代0次，平均loss为0.0002602049498818815
迭代1600次，平均loss为0.0034207801800221205
迭代3200次，平均loss为0.0020793930161744356
迭代4800次，平均loss为0.0002835669438354671
迭代6400次，平均loss为0.016864685341715813
迭代8000次，平均loss为0.0004315364931244403
迭代9600次，平均loss为0.00017606843903195113
迭代11200次，平均loss为0.006604318972676992
迭代12800次，平均loss为0.0021630381233990192
epoch13训练完毕，loss 为：0.0015509001116836506
训练集因果的平均precision:0.9992014692964944, recall:0.9975286989795918, f1:0.9983643834523477
测试集因果的平均precision:0.7503949447077409, recall:0.6954612005856515, f1:0.7218844984802432
训练集混淆矩阵：
[[218336     10      0      0      0]
 [    12   6002      0      0      0]
 [     3      0    297      0      0]
 [    16      0      0   5998      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46048    73     3    53     1]
 [   96   228     1     3     0]
 [    1    13     2     0     0]
 [   83     0     0   243     2]
 [    0     0     0     9     2]]
--------------------------------------------------
epoch:14
迭代0次，平均loss为6.825572927482426e-05
迭代1600次，平均loss为0.0020402627997100353
迭代3200次，平均loss为0.0003262402897235006
迭代4800次，平均loss为0.00020712688274215907
迭代6400次，平均loss为0.00011103291035396978
迭代8000次，平均loss为0.0001306198537349701
迭代9600次，平均loss为0.0005007492727600038
迭代11200次，平均loss为0.012741697952151299
迭代12800次，平均loss为0.0002827745920512825
epoch14训练完毕，loss 为：0.001507775266272712
训练集因果的平均precision:0.9987229627264745, recall:0.9975286989795918, f1:0.9981254736170383
测试集因果的平均precision:0.7378497790868925, recall:0.7335285505124451, f1:0.73568281938326
训练集混淆矩阵：
[[218330     12      2      2      0]
 [    15   5999      0      0      0]
 [     0      0    300      0      0]
 [    16      0      0   5998      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46026    88     4    60     0]
 [   84   241     0     2     1]
 [    1    12     3     0     0]
 [   71     0     0   255     2]
 [    0     0     0     9     2]]
--------------------------------------------------
epoch:15
迭代0次，平均loss为4.875302329310216e-05
迭代1600次，平均loss为0.0011357221519574523
迭代3200次，平均loss为4.481093492358923e-05
迭代4800次，平均loss为0.00026284827617928386
迭代6400次，平均loss为0.00020031370513606817
迭代8000次，平均loss为9.950047387974337e-05
迭代9600次，平均loss为4.6232627937570214e-05
迭代11200次，平均loss为0.0002894630015362054
迭代12800次，平均loss为5.046485239290632e-05
epoch15训练完毕，loss 为：0.0014501070884408217
训练集因果的平均precision:0.9980847498204453, recall:0.9970503826530612, f1:0.9975672981056829
测试集因果的平均precision:0.7234957020057307, recall:0.739385065885798, f1:0.7313540912382331
训练集混淆矩阵：
[[218324      8      2     12      0]
 [    16   5997      0      1      0]
 [     0      0    300      0      0]
 [    19      0      0   5994      1]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46011    88     4    75     0]
 [   86   237     2     2     1]
 [    1     9     6     0     0]
 [   65     1     0   260     2]
 [    0     0     0     9     2]]
--------------------------------------------------
epoch:16
迭代0次，平均loss为6.780009425710887e-05
迭代1600次，平均loss为0.00013344692706596106
迭代3200次，平均loss为0.00019536522449925542
迭代4800次，平均loss为0.00013580477389041334
迭代6400次，平均loss为0.00010906582610914484
迭代8000次，平均loss为0.0002367465931456536
迭代9600次，平均loss为0.0003363698779139668
迭代11200次，平均loss为0.00023589693591929972
迭代12800次，平均loss为0.0001942067319760099
epoch16训练完毕，loss 为：0.0016047478974869232
训练集因果的平均precision:0.9986431478968792, recall:0.9974489795918368, f1:0.9980457065369123
测试集因果的平均precision:0.7238372093023255, recall:0.7291361639824304, f1:0.7264770240700218
训练集混淆矩阵：
[[218329     11      0      6      0]
 [    18   5996      0      0      0]
 [     2      0    298      0      0]
 [    12      0      0   6002      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46012   106     4    56     0]
 [   84   241     0     2     1]
 [    1    12     3     0     0]
 [   74     2     0   252     0]
 [    2     0     0     7     2]]
--------------------------------------------------
epoch:17
迭代0次，平均loss为0.0035890834406018257
迭代1600次，平均loss为8.016181527636945e-05
迭代3200次，平均loss为3.656972694443539e-05
迭代4800次，平均loss为0.00010526567348279059
迭代6400次，平均loss为4.8709698603488505e-05
迭代8000次，平均loss为5.751871503889561e-05
迭代9600次，平均loss为0.0001417466119164601
迭代11200次，平均loss为4.990454181097448e-05
迭代12800次，平均loss为6.983338244026527e-05
epoch17训练完毕，loss 为：0.001110924841404412
训练集因果的平均precision:0.9969759668947955, recall:0.9987244897959183, f1:0.9978494623655914
测试集因果的平均precision:0.7126760563380282, recall:0.7408491947291361, f1:0.7264895908111989
训练集混淆矩阵：
[[218308     20      2     16      0]
 [    10   6004      0      0      0]
 [     0      0    300      0      0]
 [     6      0      0   6008      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46001    90     3    83     1]
 [   83   241     1     2     1]
 [    2    12     2     0     0]
 [   64     0     0   261     3]
 [    1     0     0     8     2]]
--------------------------------------------------
epoch:18
迭代0次，平均loss为3.391984500922263e-05
迭代1600次，平均loss为3.96507020923309e-05
迭代3200次，平均loss为0.0003903956967405975
迭代4800次，平均loss为3.6702575016533956e-05
迭代6400次，平均loss为0.00021507509518414736
迭代8000次，平均loss为0.00032599878613837063
迭代9600次，平均loss为0.004376768134534359
迭代11200次，平均loss为0.00040381800499744713
迭代12800次，平均loss为0.00026289818924851716
epoch18训练完毕，loss 为：0.0013338384846190757
训练集因果的平均precision:0.9956283284317622, recall:0.9985650510204082, f1:0.9970945273631842
测试集因果的平均precision:0.7153284671532847, recall:0.7174231332357247, f1:0.7163742690058481
训练集混淆矩阵：
[[218291     18      8     29      0]
 [    14   6000      0      0      0]
 [     0      0    300      0      0]
 [     4      0      0   6010      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46011    80     4    82     1]
 [   96   228     1     2     1]
 [    3    10     3     0     0]
 [   66     0     0   257     5]
 [    0     0     0     9     2]]
--------------------------------------------------
epoch:19
迭代0次，平均loss为0.003345004515722394
迭代1600次，平均loss为4.1321804019389674e-05
迭代3200次，平均loss为5.614149631583132e-05
迭代4800次，平均loss为0.0001772991381585598
迭代6400次，平均loss为3.526568616507575e-05
迭代8000次，平均loss为3.3080355933634564e-05
迭代9600次，平均loss为7.588182779727504e-05
迭代11200次，平均loss为0.0005307825049385428
迭代12800次，平均loss为0.004136852454394102
epoch19训练完毕，loss 为：0.001153123897942521
训练集因果的平均precision:0.998324958123953, recall:0.9977678571428571, f1:0.9980463298911527
测试集因果的平均precision:0.7427258805513017, recall:0.7101024890190337, f1:0.7260479041916168
训练集混淆矩阵：
[[218327     10      5      4      0]
 [    14   6000      0      0      0]
 [     0      0    300      0      0]
 [    12      0      0   6000      2]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46036    73     4    63     2]
 [   96   229     0     2     1]
 [    3    11     2     0     0]
 [   72     1     0   249     6]
 [    1     0     0     5     5]]
--------------------------------------------------
epoch:20
迭代0次，平均loss为0.0010163465049117804
迭代1600次，平均loss为0.00023132054775487632
迭代3200次，平均loss为3.466206180746667e-05
迭代4800次，平均loss为0.000301257154205814
迭代6400次，平均loss为4.0223450923804194e-05
迭代8000次，平均loss为0.00016303290612995625
迭代9600次，平均loss为6.259478686843067e-05
迭代11200次，平均loss为2.6855221221921965e-05
迭代12800次，平均loss为0.00016562719247303903
epoch20训练完毕，loss 为：0.0010041802289768903
训练集因果的平均precision:0.9972144846796658, recall:0.9988839285714286, f1:0.9980485085029273
测试集因果的平均precision:0.7163531114327062, recall:0.7247437774524158, f1:0.720524017467249
训练集混淆矩阵：
[[218311     20      5     10      0]
 [     7   6007      0      0      0]
 [     0      0    300      0      0]
 [     7      0      0   6007      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46008    87     3    79     1]
 [   89   236     0     3     0]
 [    2    12     2     0     0]
 [   71     0     0   255     2]
 [    0     0     0     9     2]]
--------------------------------------------------
epoch:21
迭代0次，平均loss为2.8728552933898754e-05
迭代1600次，平均loss为0.0002373833121964708
迭代3200次，平均loss为2.600672269181814e-05
迭代4800次，平均loss为0.0011288024252280593
迭代6400次，平均loss为0.00033134053228423
迭代8000次，平均loss为3.6130277294432744e-05
迭代9600次，平均loss为3.539687895681709e-05
迭代11200次，平均loss为8.922784763853997e-05
迭代12800次，平均loss为4.723675738205202e-05
epoch21训练完毕，loss 为：0.0009328663759266518
训练集因果的平均precision:0.9982464530527658, recall:0.998405612244898, f1:0.998326026305301
测试集因果的平均precision:0.7004160887656034, recall:0.739385065885798, f1:0.7193732193732194
训练集混淆矩阵：
[[218324      6      0     16      0]
 [    16   5998      0      0      0]
 [     2      0    298      0      0]
 [     2      0      0   6012      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[45990   112     3    70     3]
 [   80   245     0     3     0]
 [    1    12     3     0     0]
 [   69     2     0   254     3]
 [    0     0     0     8     3]]
--------------------------------------------------
epoch:22
迭代0次，平均loss为0.00012247468112036586
迭代1600次，平均loss为8.884751878213137e-05
迭代3200次，平均loss为3.5347387893125415e-05
迭代4800次，平均loss为8.732911373954266e-05
迭代6400次，平均loss为8.62720116856508e-05
迭代8000次，平均loss为2.6875170078710653e-05
迭代9600次，平均loss为3.589599873521365e-05
迭代11200次，平均loss为0.0004117531352676451
迭代12800次，平均loss为6.934668635949492e-05
epoch22训练完毕，loss 为：0.0012248365977526917
训练集因果的平均precision:0.9983214771001518, recall:0.9956951530612245, f1:0.9970065855118739
测试集因果的平均precision:0.7100840336134454, recall:0.7423133235724744, f1:0.7258410880458124
训练集混淆矩阵：
[[218335      3      2      6      0]
 [    24   5985      4      1      0]
 [     4      0    296      0      0]
 [    16      0      0   5993      5]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[45999    85     2    88     4]
 [   84   239     2     2     1]
 [    2    11     3     0     0]
 [   61     0     0   261     6]
 [    1     0     0     6     4]]
--------------------------------------------------
epoch:23
迭代0次，平均loss为3.9501966966781765e-05
迭代1600次，平均loss为6.711533205816522e-05
迭代3200次，平均loss为0.0043800463899970055
迭代4800次，平均loss为6.474580732174218e-05
迭代6400次，平均loss为4.457545219338499e-05
迭代8000次，平均loss为0.0002089138433802873
迭代9600次，平均loss为0.00011991712381131947
迭代11200次，平均loss为0.0006205331301316619
迭代12800次，平均loss为0.011550944298505783
epoch23训练完毕，loss 为：0.0012989796013257345
训练集因果的平均precision:0.9996003836317136, recall:0.9970503826530612, f1:0.9983237547892719
测试集因果的平均precision:0.7093184979137691, recall:0.746705710102489, f1:0.7275320970042796
训练集混淆矩阵：
[[218341      1      2      2      0]
 [    24   5990      0      0      0]
 [     0      0    300      0      0]
 [    13      0      0   6001      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[45996    99     2    80     1]
 [   81   242     2     2     1]
 [    2    11     3     0     0]
 [   62     0     0   263     3]
 [    1     0     0     8     2]]
--------------------------------------------------
epoch:24
迭代0次，平均loss为0.00014956611266825348
迭代1600次，平均loss为0.00011602698941715062
迭代3200次，平均loss为5.5399141274392605e-05
迭代4800次，平均loss为0.00017100179684348404
迭代6400次，平均loss为0.00025759325944818556
迭代8000次，平均loss为7.619733514729887e-05
迭代9600次，平均loss为6.768641469534487e-05
迭代11200次，平均loss为6.344838038785383e-05
迭代12800次，平均loss为6.14520104136318e-05
epoch24训练完毕，loss 为：0.0010045511835952432
训练集因果的平均precision:0.9995205369985616, recall:0.9971301020408163, f1:0.9983238885784979
测试集因果的平均precision:0.7285714285714285, recall:0.746705710102489, f1:0.7375271149674621
训练集混淆矩阵：
[[218340      2      2      2      0]
 [    22   5992      0      0      0]
 [     0      0    300      0      0]
 [    14      0      0   6000      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46015    93     4    65     1]
 [   79   244     2     3     0]
 [    1    12     3     0     0]
 [   65     0     0   261     2]
 [    1     0     0     8     2]]
--------------------------------------------------
epoch:25
迭代0次，平均loss为0.0004875459708273411
迭代1600次，平均loss为3.378334076842293e-05
迭代3200次，平均loss为3.9359580114251e-05
迭代4800次，平均loss为0.001164733781479299
迭代6400次，平均loss为0.0011876651551574469
迭代8000次，平均loss为2.6619214622769505e-05
迭代9600次，平均loss为2.7708148991223425e-05
迭代11200次，平均loss为0.00015899927529972047
迭代12800次，平均loss为4.212783824186772e-05
epoch25训练完毕，loss 为：0.0009590339773800009
训练集因果的平均precision:0.9992010226909556, recall:0.9969706632653061, f1:0.9980845969672786
测试集因果的平均precision:0.717948717948718, recall:0.7379209370424598, f1:0.7277978339350181
训练集混淆矩阵：
[[218336      5      2      3      0]
 [    22   5992      0      0      0]
 [     0      0    300      0      0]
 [    16      0      0   5998      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46005   101     4    67     1]
 [   80   244     1     3     0]
 [    4    10     2     0     0]
 [   69     0     0   256     3]
 [    1     0     0     8     2]]
--------------------------------------------------
epoch:26
迭代0次，平均loss为0.00018338003428652883
迭代1600次，平均loss为0.0001504087122157216
迭代3200次，平均loss为0.0010320448782294989
迭代4800次，平均loss为0.003365636570379138
迭代6400次，平均loss为0.00014048021694179624
迭代8000次，平均loss为0.0030581937171518803
迭代9600次，平均loss为0.00012332665210124105
迭代11200次，平均loss为2.400251651124563e-05
迭代12800次，平均loss为0.011756792664527893
epoch26训练完毕，loss 为：0.0011053624666915154
训练集因果的平均precision:0.9977685686962066, recall:0.9980867346938775, f1:0.9979276263350869
测试集因果的平均precision:0.701534170153417, recall:0.7364568081991215, f1:0.7185714285714284
训练集混淆矩阵：
[[218318     24      2      2      0]
 [     5   6009      0      0      0]
 [     0      0    300      0      0]
 [    19      0      0   5995      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[45991   103     3    81     0]
 [   82   240     3     3     0]
 [    3    10     3     0     0]
 [   67     0     0   257     4]
 [    1     0     0     7     3]]
--------------------------------------------------
epoch:27
迭代0次，平均loss为6.491359090432525e-05
迭代1600次，平均loss为0.00022884159989189357
迭代3200次，平均loss为2.6925792553811334e-05
迭代4800次，平均loss为0.00121869589202106
迭代6400次，平均loss为0.0007850743131712079
迭代8000次，平均loss为8.080223778961226e-05
迭代9600次，平均loss为0.0018376647494733334
迭代11200次，平均loss为0.0009688058635219932
迭代12800次，平均loss为6.21706567471847e-05
epoch27训练完毕，loss 为：0.0010668552166181353
训练集因果的平均precision:0.9966523194643712, recall:0.9968112244897959, f1:0.9967317656436828
测试集因果的平均precision:0.7274074074074074, recall:0.718887262079063, f1:0.7231222385861561
训练集混淆矩阵：
[[218320     15      2      9      0]
 [    13   5985     16      0      0]
 [     0      0    300      0      0]
 [    11      0      0   6003      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46016    91     6    65     0]
 [   86   237     2     3     0]
 [    4     8     4     0     0]
 [   78     0     0   248     2]
 [    2     0     0     7     2]]
--------------------------------------------------
epoch:28
迭代0次，平均loss为0.003289866494014859
迭代1600次，平均loss为2.007622242672369e-05
迭代3200次，平均loss为1.698944288364146e-05
迭代4800次，平均loss为3.4080087061738595e-05
迭代6400次，平均loss为1.3169836165616289e-05
迭代8000次，平均loss为0.0001231261994689703
迭代9600次，平均loss为1.9250197510700673e-05
迭代11200次，平均loss为1.9353290554136038e-05
迭代12800次，平均loss为0.0102761909365654
epoch28训练完毕，loss 为：0.0008709743587639105
训练集因果的平均precision:0.999281322366845, recall:0.9976084183673469, f1:0.9984441696254038
测试集因果的平均precision:0.7447129909365559, recall:0.7218155197657394, f1:0.7330855018587361
训练集混淆矩阵：
[[218337      3      2      4      0]
 [    20   5994      0      0      0]
 [     0      0    300      0      0]
 [    10      0      0   6004      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[46032    85     3    58     0]
 [   86   239     0     3     0]
 [    4    10     2     0     0]
 [   76     0     0   250     2]
 [    1     0     0     8     2]]
--------------------------------------------------
epoch:29
迭代0次，平均loss为1.4518458556267433e-05
迭代1600次，平均loss为1.5795290892128833e-05
迭代3200次，平均loss为1.8874845409300178e-05
迭代4800次，平均loss为1.8342787370784208e-05
迭代6400次，平均loss为0.00046437676064670086
迭代8000次，平均loss为5.6554974435130134e-05
迭代9600次，平均loss为0.0020188293419778347
迭代11200次，平均loss为1.4430275768972933e-05
迭代12800次，平均loss为0.009882709011435509
epoch29训练完毕，loss 为：0.0008799271906104094
训练集因果的平均precision:0.9972916998566194, recall:0.9980867346938775, f1:0.9976890588891545
测试集因果的平均precision:0.6458333333333334, recall:0.7715959004392386, f1:0.7031354236157439
训练集混淆矩阵：
[[218312     25      0      9      0]
 [    10   6004      0      0      0]
 [     2      0    298      0      0]
 [    12      0      0   6002      0]
 [     0      0      0      0    216]]
测试集混淆矩阵：
[[45919   142     3   113     1]
 [   67   256     0     5     0]
 [    1    13     2     0     0]
 [   58     0     0   267     3]
 [    0     0     0     9     2]]
--------------------------------------------------
--------------------------------------------------
训练结束，保存模型
--------------------------------------------------
训练结束，最好的f1值为0.74235807860262， 混淆矩阵为[[46022    82     5    69     0]
 [   85   239     1     2     1]
 [    1    10     5     0     0]
 [   62     0     0   262     4]
 [    0     0     0     7     4]]
模型保存完毕
